# API拦截器 - LangGraph Agent功能

本应用集成了LangGraph框架，提供智能API分析和调用功能。

## 功能特性

### 1. 智能API分析
- 使用LangGraph构建的AI Agent自动分析拦截到的API
- 生成详细的API文档，包括功能描述、参数说明、使用场景等
- 支持批量分析多个API

### 2. 知识库管理
- 使用SQLite数据库存储API文档
- 支持API搜索、分类、统计
- 自动记录API调用历史和频率

### 3. 智能聊天助手
- 在聊天中询问问题，AI会自动选择合适的API来回答
- 支持自然语言理解用户意图
- 自动调用API并格式化响应结果

## 配置说明

### 1. 环境配置
复制 `.env.example` 文件为 `.env` 并配置：

```bash
cp .env.example .env
```

在 `.env` 文件中设置你的OpenAI API密钥：

```
OPENAI_API_KEY=your-actual-api-key
OPENAI_BASE_URL=https://api.openai.com/v1
```

### 2. 支持的AI服务
- OpenAI GPT-4/GPT-3.5
- 任何OpenAI兼容的API服务
- 可以通过修改 `OPENAI_BASE_URL` 使用其他服务

## 使用方法

### 1. 拦截API
1. 在第三栏输入网址并加载网页
2. 点击"开始拦截"按钮
3. 在网页中进行操作，系统会自动拦截API请求

### 2. 分析API
1. 在工具面板点击"批量AI分析"按钮
2. AI会自动分析所有拦截到的API
3. 分析结果保存到知识库中

### 3. 智能聊天
在聊天框中询问问题，例如：
- "我的用户信息是什么？"
- "帮我获取积分余额"
- "显示最近的订单"

AI会自动：
1. 理解你的问题意图
2. 从知识库中找到相关API
3. 调用API获取数据
4. 用自然语言回答你的问题

### 4. 知识库管理
- **搜索API**: 在知识库面板搜索特定API
- **查看统计**: 点击"查看统计"了解知识库概况
- **导出数据**: 点击"导出知识库"保存所有API文档

## Agent架构

### API分析Agent (`api-analyzer.js`)
- 使用LangGraph构建工作流
- 分析API的URL、参数、响应结构
- 推断API功能和使用场景
- 生成结构化的API文档

### 知识库管理 (`knowledge-base.js`)
- SQLite数据库存储
- API文档CRUD操作
- 搜索和统计功能
- 调用历史记录

### 智能调用Agent (`api-caller.js`)
- 理解用户自然语言意图
- 匹配合适的API
- 自动构造API请求
- 格式化响应结果

### Agent管理器 (`agent-manager.js`)
- 统一管理所有Agent
- 提供高层次的API接口
- 处理Agent之间的协调

## 技术栈

- **LangGraph**: Agent工作流框架
- **LangChain**: LLM集成
- **SQLite**: 知识库存储
- **Electron**: 桌面应用框架
- **OpenAI GPT**: 自然语言处理

## 故障排除

### 1. API分析失败
- 检查OpenAI API密钥是否正确
- 确认网络连接正常
- 查看控制台错误日志

### 2. 数据库错误
- 检查`data`目录是否有写入权限
- 重新启动应用重建数据库

### 3. API调用失败
- 确认目标API仍然有效
- 检查请求参数是否正确
- 查看网络请求日志

## 示例场景

假设你访问了一个积分商城网站：

1. **拦截阶段**: 系统拦截到获取用户积分的API
2. **分析阶段**: AI分析得出这是"获取用户积分余额"的API
3. **存储阶段**: API文档保存到知识库
4. **使用阶段**: 你问"我有多少积分？"
5. **智能调用**: AI自动调用积分API并回答"您当前有1250个积分"

这样就实现了从API拦截到智能使用的完整流程！